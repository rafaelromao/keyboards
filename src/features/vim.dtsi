/*
*
* Copyright (c) 2022 Rafael Rom√£o
* SPDX-License-Identifier: MIT
*
*/

/ {
    vim {
        MACRO(mc_spc_esc,         &kp A &macro_press &kp SPACE &macro_pause_for_release &macro_release &kp SPACE &macro_tap &kp ESC)
        MACRO(mc_dqt0p,           &kp DQT &kp SPACE &kp N0 &kp P)
        MACRO(mc_dqt1p,           &kp DQT &kp SPACE &kp N1 &kp P)
        MACRO(mc_dqtplusp,        &kp DQT &kp SPACE &kp PLUS &kp P)
        MACRO(mc_dqtplusy,        &kp DQT &kp SPACE &kp PLUS &kp Y)
        MACRO(mc_vim_replace,     &kp COLON &kp PERCENT &kp S &kp SLASH &to ALPHA1)

        mc_caret: mc_caret {
            compatible = "zmk,behavior-macro";
            #binding-cells = <0>;
            wait-ms = <0>;
            tap-ms = <0>;
            bindings = <&macro_tap &kp CARET &kp SPACE>;
        };

        mc_zero: mc_zero {
            compatible = "zmk,behavior-macro";
            #binding-cells = <0>;
            wait-ms = <0>;
            tap-ms = <0>;
            bindings = <&macro_tap &kp N0>;
        };

        vim_home: vim_home {
            compatible = "zmk,behavior-adaptive-key";
            #binding-cells = <0>;
            bindings = <&mc_caret>;

            ADAPTIVE(caret_zero, &mc_zero, SPACE)
        };

        TAPHOLD_TP(th_caret_z, &vim_home, &mc_zero)


        MACRO(mc_o_esc,     &macro_tap &kp O &kp ESC)
        MACRO(mc_sft_o_esc, &macro_tap &kp LS(O) &kp ESC)

        MACRO(mc_colon_a1,  &tog_off VIM &kp COLON)
        MACRO(mc_slash_a1,  &tog_off VIM &kp SLASH)
        MACRO(mc_qmark_a1,  &tog_off VIM &kp QMARK)

        MACRO(mc_left_a1,   &tog_off VIM &kp LEFT )
        MACRO(mc_right_a1,  &tog_off VIM &kp RIGHT)
        MACRO(mc_enter_a1,  &tog_off VIM &kp ENTER)
        MACRO(mc_esc_a1,    &tog_off VIM &kp ESC  )

        MOD_MORPH_KM(mm_left_a1 , MOD_LALT|MOD_RALT|MOD_LCTL|MOD_RCTL|MOD_LSFT|MOD_RSFT|MOD_LGUI|MOD_RGUI, &mc_left_a1, &kp LEFT)
        MOD_MORPH_KM(mm_right_a1, MOD_LALT|MOD_RALT|MOD_LCTL|MOD_RCTL|MOD_LSFT|MOD_RSFT|MOD_LGUI|MOD_RGUI, &mc_right_a1, &kp RIGHT)
        MOD_MORPH_KM(mm_enter_a1, MOD_LALT|MOD_RALT|MOD_LCTL|MOD_RCTL|MOD_LSFT|MOD_RSFT|MOD_LGUI|MOD_RGUI, &mc_enter_a1, &kp ENTER)
        MOD_MORPH_KM(mm_esc_a1  , MOD_LALT|MOD_RALT|MOD_LCTL|MOD_RCTL|MOD_LSFT|MOD_RSFT|MOD_LGUI|MOD_RGUI, &mc_esc_a1, &kp ESC)

        MACRO(mc_esc_vim,   &macro_tap &kp ESC &to VIM)
        MACRO(mc_ent_vim,   &macro_tap &kp ENTER &to VIM)

        MACRO(mc_o_a1,  &kp O &tog_off VIM)
        MACRO(mc_a_a1,  &kp A &tog_off VIM)
        MACRO(mc_i_a1,  &kp I &tog_off VIM)
        MACRO(mc_c_a1,  &kp C &tog_off VIM &fsl VIM)
        MACRO(mc_s_a1,  &kp S &tog_off VIM)
        MACRO(mc_r_p1,  &kp R &sl PLAIN1)

        MODTAP_TP(mt_i_a1, &mc_i_a1)
        MODTAP_TP(mt_c_a1, &mc_c_a1)
        MODTAP_TP(mt_s_a1, &mc_s_a1)
        MODTAP_TP(mt_r_p1, &mc_r_p1)
    };
};
